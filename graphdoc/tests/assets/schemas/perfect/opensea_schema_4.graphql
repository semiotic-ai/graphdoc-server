# Subgraph Schema: NFT Marketplace
# Version: 1.0.0

" Represents the blockchain network that the data is being collected from. "
enum Network {
  " The Arbitrum One network. "
  ARBITRUM_ONE
  " The Arweave Mainnet. "
  ARWEAVE_MAINNET
  " The Aurora network. "
  AURORA
  " The Avalanche network. "
  AVALANCHE
  " The Boba network. "
  BOBA
  " The Binance Smart Chain network (aka BNB Chain). "
  BSC 
  " The Celo network. "
  CELO
  " The Cosmos network. "
  COSMOS
  " The Cronos network. "
  CRONOS
  " The Ethereum Mainnet. "
  MAINNET 
  " The Fantom network. "
  FANTOM
  " The Fuse network. "
  FUSE
  " The Harmony network. "
  HARMONY
  " The Juno network. "
  JUNO
  " The Moonbeam network. "
  MOONBEAM
  " The Moonriver network. "
  MOONRIVER
  " The NEAR Mainnet. "
  NEAR_MAINNET
  " The Optimism network. "
  OPTIMISM
  " The Osmosis network. "
  OSMOSIS
  " The Matic network (aka Polygon). "
  MATIC
  " The xDai network (aka Gnosis Chain). "
  XDAI 
}

" The NFT standard that the collection uses. This is a defined standard that the Ethereum blockchain uses to create NFTs. "
enum NftStandard {
  " The ERC721 NFT standard. "
  ERC721
  " The ERC1155 NFT standard. "
  ERC1155
  " An unknown NFT standard. "
  UNKNOWN
}

" Represents a sales strategy that executes an order. There are five types of sale strategies: Standard Sale, Any Item from Collection, Any Item from Set, Dutch Auction, and Private Sale. "
enum SaleStrategy {
  " Represents a sales strategy that executes an order at a fixed price that can be taken either by a bid or an ask. "
  STANDARD_SALE

  " Represents a sales strategy that executes an order at a fixed price that can be matched by any tokenId for the collection. "
  ANY_ITEM_FROM_COLLECTION

  " Represents a sales strategy that executes an order at a fixed price that can be matched by any tokenId in a set of tokenIds. "
  ANY_ITEM_FROM_SET

  " Represents a trategy to launch a Dutch Auction for a token where the price decreases linearly until a specified timestamp and end price defined by the seller. "
  DUTCH_AUCTION

  " Represents a strategy to set up an order that can only be executed by a specific address (aka a Private Sale). "
  PRIVATE_SALE
}

" A marketplace is a platform where NFTs are traded. This is a unique entity that maps to marketplaces (smart contracts) on the blockchain. "
type Marketplace @entity @regularPolling {
  " Smart contract address of the protocol's main contract (Factory, Registry, etc) "
  id: ID!

  " Human readable name of the NFT marketplace, in this case OpenSea. "
  name: String!

  " The human readable trading slug of the NFT marketplace, in this case opensea. "
  slug: String!

  " The blockchain network this subgraph is indexing on. This corresponds to the network that data is being collected from. Options are presented in the Enum above. "
  network: Network!

  " This is the version of the schema, in SemVer format (e.g. 1.0.0), that the subgraph is implementing. This is because this schema is built from a common standard that is maintained by Messari. "
  schemaVersion: String!

  " This is the version of the subgraph implementation, in SemVer format (e.g. 1.0.0), that the subgraph is implementing. This is independent of schema, and pertains to how various actions update relevant fields. This is because this schema is built from a common standard that is maintained by Messari. "
  subgraphVersion: String!

  " This is the version of the methodology used to compute metrics, loosely based on SemVer format (e.g. 1.0.0). This is because the methodology used to compute metrics may change over time, and this field is used to track those changes. "
  methodologyVersion: String!

  " This is a field that is updated to reflect the number of collections listed on the marketplace. A collection is a group of NFTs that are created by the same creator. "
  collectionCount: Int!

  " This is a field that is updated to reflect the number of trades that have occurred on the marketplace, and is inclusive of all collections. "
  tradeCount: Int!

  " This is a field that is updated to reflect the cumulative trade volume in ETH that has occurred on the marketplace. Includes all trades from all collections. "
  cumulativeTradeVolumeETH: BigDecimal!

  " The revenue (in ETH) that goes to the marketplace protocol, aka protocol fee. This is the fee that is taken by the marketplace protocol for facilitating trades. "
  marketplaceRevenueETH: BigDecimal!

  " This is the cumulative fees (in ETH) that have been taken by the creators of NFTs on the markeplace when they are traded. This is akin to a royalty fee. "
  creatorRevenueETH: BigDecimal!

  " This is the total revenue that has been generated by the marketplace. This is calculated by adding the marketplace revenue and the creator revenue. "
  totalRevenueETH: BigDecimal!

  " This is a field that is updated to reflect the number of unique traders that have participated in trades on the marketplace. "
  cumulativeUniqueTraders: Int!
}

" A collection is a group of NFTs that are created by the same creator. This is a unique entity that maps to collections on the marketplace. "
type Collection @entity @regularPolling {
  " This is the unique identifier for the collection, and is the contract address of the collection. "
  id: ID!

  " This is the name of the collection, and is the name that is given to the collection by the creator. It is mirrored from the smart contract, and left null if not available. "
  name: String

  " This is the symbol of the collection, and is the symbol that is given to the collection by the creator. It is mirrored from the smart contract, and left null if not available. "
  symbol: String

  " This is the total supply of the collection (number of NFTs within a given collection), and is mirrored from the smart contract. "
  totalSupply: BigInt

  " This is the NFT standard that the collection uses. This can be either ERC721, ERC1155, or Unknown. It must be one of the values present within the NftStandard Enum. "
  nftStandard: NftStandard!

  " This is the fee that is taken by the creator of the NFT when it is traded. It is akin to a royalty fee. It is a fee rte in percentage. E.g. 2.5% should be 2.5. "
  royaltyFee: BigDecimal!

  " The cumulative trade volume in ETH that has occurred for the collection. This is the total value of all trades that have occurred for the collection (in ETH). "
  cumulativeTradeVolumeETH: BigDecimal!

  " The revenue that is collected by the marketplace protocol for facilitating trades of the collection (in ETH). This is akin to a protocol fee. It is represented in ETH. "
  marketplaceRevenueETH: BigDecimal!

  " The revenue that is collected by the creator of the NFT when it is traded (in ETH). This is akin to a royalty fee. It is represented in ETH. "
  creatorRevenueETH: BigDecimal!

  " The total revenue that has been generated by the collection (in ETH). This is calculated by adding the marketplace revenue and the creator revenue. It is represented in ETH. "
  totalRevenueETH: BigDecimal!

  " This is the number of trades that have occurred for the collection on the marketplace. Each trade is a unique transaction. "
  tradeCount: Int!

  " The total number of unique buyers that have participated in trades for the collection. "
  buyerCount: Int!

  " The total number of unique sellers that have participated in trades for the collection. "
  sellerCount: Int!

  " This maps to the Trade entity, and is a list of trades that have occurred for the collection. "
  trades: [Trade!]! @derivedFrom(field: "collection")
}

" Trades exist such as a combination of taker/order and bid/ask. "
type Trade @entity @transaction {
  " The id for a trade is combination of the following components: { Transaction hash }-{ Log index }-{ (optional) ID within bundle } "
  id: ID!

  " The transaction has that the trade is executed in. This is a unique identifier for the transaction. It is possible that multiple trades are executed in a single transaction. "
  transactionHash: String!

  " This represents the index of the log within the transaction. It is a unique identifier for the log within the transaction. The event corresponds to a trade event. "
  logIndex: Int

  " Block timestamp where the trade is executed. This is based on the timestamp of the block where the trade is executed. "
  timestamp: BigInt!

  " Block number where the trade is executed. A block is a collection of transactions that are executed on the blockchain. "
  blockNumber: BigInt!

  " Whether the trade is in a bundle. Trades can be in a bundle, which means that multiple NFTs are traded together. "
  isBundle: Boolean!

  " Collection involved. This is the collection that the trade, and corresponding NFT, is associated with. "
  collection: Collection!

  " The token ID is the unique identifier for the NFT that is traded. It is unique within the collection. "
  tokenId: BigInt!

  " The amount of token to transfer. It is set at 1 except for ERC1155 batch. "
  amount: BigInt!

  " Price (in ETH). If only 1 tokenId is involved, then the price is determined by the token only. If the trade is incurred by a batch purchasing (available in x2y2), then the price is the average price in the batch. "
  priceETH: BigDecimal!

  " The strategy that the trade is executed with. This is a sale strategy that is used to execute the trade. It is defined by the SaleStrategy Enum. "
  strategy: SaleStrategy!

  " The buyer account address is the address of the account that is purchasing the NFT(s). "
  buyer: String!

  " The seller account address is the address of the account that is selling the NFT(s). "
  seller: String!
}

" A daily snapshot of the marketplace. This entity tracks the daily metrics of the marketplace. "
type MarketplaceDailySnapshot @entity @dailySnapshot {
  " The id for a daily snapshot of the marketplace is a combination of the contract address and the number of days since the Unix epoch time: { Contract address }-{# of days since Unix epoch time } "
  id: ID!

  " This maps to the Marketplace entity that the snapshot is of. "
  marketplace: Marketplace!

  " This is the block number when the snapshot was taken. It is a unique identifier for the block based on the network the marketplace is on. "
  blockNumber: BigInt!

  " This is the timestamp of the block when the snapshot was taken. The timestamp is a Unix timestamp. "
  timestamp: BigInt!

  " A cumulative count of all collections listed on the marketplace. This is a value determined at the time of the snapshot. "
  collectionCount: Int!

  " The total trading volume in ETH that has occurred on the marketplace during the day of the snapshot. This is the total value of all trades that have occurred on the marketplace in the given day. "
  cumulativeTradeVolumeETH: BigDecimal!

  " The total revenue generated by the marketplace protocol during the day of the snapshot. This is the fee that is taken by the marketplace protocol for facilitating trades. This is akin to a protocol fee. "
  marketplaceRevenueETH: BigDecimal!

  " The total creator revenue collected on the marketplace during the day of the snapshot. This is the fee that is taken by the creators of NFTs on the markeplace when they are traded. This is akin to a royalty fee. "
  creatorRevenueETH: BigDecimal!

  " The total revenue that has been generated by the marketplace during the day of the snapshot. This is calculated by adding the marketplace revenue and the creator revenue. "
  totalRevenueETH: BigDecimal!

  " The total number of trades that have occurred on the marketplace during the day of the snapshot. "
  tradeCount: Int!

  " The number of unique traders that have participated in trades on the marketplace for the given day. This is a cumulative count of all unique traders that have participated in trades on the marketplace on that day. "
  cumulativeUniqueTraders: Int!

  " The number of unique traders that have participated in trades on the marketplace for the given day. This is a count of all unique traders that have participated in trades on the marketplace on that day. "
  dailyActiveTraders: Int!

  " The number of collections that have been traded on the marketplace during the day of the snapshot. This is a cumulative value of the distinct collections that have been traded on the marketplace on that day. "
  dailyTradedCollectionCount: Int!

  " The number of traded items that have been traded on the marketplace during the day of the snapshot. This is a count of all NFTs that have been traded on the marketplace on that day. "
  dailyTradedItemCount: Int!
}

" A daily snapshot of a collection. This entity tracks the daily metrics of a collection. "
type CollectionDailySnapshot @entity @dailySnapshot {
  " The id for a daily snapshot of a collection is a combination of the contract address and the number of days since the Unix epoch time: { Contract address }-{# of days since epoch unix time } "
  id: ID!

  " This maps to the Collection entity that the snapshot is of. The collection is a group of NFTs that are created by the same creator. "
  collection: Collection!

  " Block number when the snapshot was taken. It is a unique identifier for the block based on the network the collection is on. "
  blockNumber: BigInt!

  " The block timestamp of the block when the snapshot was taken. The timestamp is a Unix timestamp. "
  timestamp: BigInt!

  " The royalty fee is the fee that is taken by the creator of the NFT when it is traded. It is akin to a royalty fee. It is a fee rate in percentage. E.g. 2.5% should be 2.5. "
  royaltyFee: BigDecimal!

  " The minimum sale price of the day (in ETH) is the lowest price that an NFT from the collection has been sold for on the marketplace during the day of the snapshot. "
  dailyMinSalePrice: BigDecimal!

  " The maximum sale price of the day (in ETH) is the highest price that an NFT from the collection has been sold for on the marketplace during the day of the snapshot. "
  dailyMaxSalePrice: BigDecimal!

  " The cumulative trade volume in ETH that has occurred for the collection in the given day. This is the total value of all trades that have occurred for the collection (in ETH) for that day. "
  cumulativeTradeVolumeETH: BigDecimal!

  " The total trading volume in ETH that has occurred for the collection during the day of the snapshot. This is the total value of all trades that have occurred for the collection in the given day. "
  dailyTradeVolumeETH: BigDecimal!

  " The revenue that is collected by the marketplace protocol for facilitating trades of the collection (in ETH) for the given day. This is akin to the total protocol fee collected for a day. "
  marketplaceRevenueETH: BigDecimal!

  " The revenue that is collected by the creator of the NFT when it is traded (in ETH) for the given day. This is akin to the total royalty fee collected for a day. "
  creatorRevenueETH: BigDecimal!

  " This is the total revenue that has been generated by the collection for the given day. This is calculated by adding the marketplace revenue and the creator revenue. "
  totalRevenueETH: BigDecimal!

  " The total number of trades that have occurred for the collection on the marketplace on a given day. Each trade is a unique transaction. "
  tradeCount: Int!

  " The total number of unique NFTs that have been traded from the collection on the marketplace on a given day. "
  dailyTradedItemCount: Int!
}

" A helper utility entity that works as a set for deduplication purpose. "
type _Item @entity {
  " The unique identifier for the item. This is a combination of the type of item and the account address. MARKETPLACE_ACCOUNT-{ Account } or COLLECTION_ACCOUNT-{ Buyer/Seller }-{ Collection ID }-{ Account } depending on the type of item. " 
  id: ID!
}
