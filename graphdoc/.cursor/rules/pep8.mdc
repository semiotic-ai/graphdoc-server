---
description: pep8 compliance refactor
globs: docs/
alwaysApply: false
---

# PEP8 Compliance Refactoring Prompt
You will help refactor a codebase to be PEP8 compliant using flake8. Follow these precise steps, stopping for feedback after each one. This methodical approach will ensure we maintain functionality while improving code quality. You have access to the terminal, and will find @run.sh contains useful scripts for you. We are solely working in the graphdoc repository, ignore mlflow-manager and other files in the root directory.

## Step 1: Run Initial PEP8 Check
First, run flake8 to identify all PEP8 violations in the codebase.
```
./run.sh pep-check
```
Analyze the output and categorize the violations into common types (e.g., line length, whitespace, imports, variable naming). List each violation type with examples and count.
STOP HERE AND WAIT FOR FEEDBACK BEFORE PROCEEDING.

## Step 2: Create a Refactoring Plan
Based on the violations found, create a prioritized refactoring plan. Group similar issues and identify files with the most violations. For each violation type:
- Describe the PEP8 rule being violated
- Explain the fix required
- Identify any potential risks to functionality

Example:
E501 (line too long): 27 occurrences - Need to wrap lines at 79 characters
E302 (missing blank lines): 15 occurrences - Add required blank lines between functions/classes
STOP HERE AND WAIT FOR FEEDBACK BEFORE PROCEEDING.

## Step 3: Fix One Violation Type at a Time
Starting with the most frequent or simplest violations, make changes to fix one type of issue at a time. For each change:
- Show the original code with the violation
- Show the refactored code
- Explain what was changed and why
IMPORTANT: Make changes systematically and conservatively, preserving all functionality.
STOP HERE AND WAIT FOR FEEDBACK BEFORE PROCEEDING.

## Step 4: Run Tests After Each Set of Changes
After fixing each violation type, run the test suite to ensure nothing broke:
```
./run.sh test
```
If tests fail:
- Document the failing tests
- Revert the most recent changes
- Propose a modified solution

If tests pass, run another PEP8 check to confirm the violations were resolved:
```
./run.sh pep-check
```
STOP HERE AND WAIT FOR FEEDBACK BEFORE PROCEEDING.

## Step 5: Iterate Until All Issues Are Resolved
Repeat Steps 3-4 for each violation type until all PEP8 issues are resolved. After each iteration:
- Report progress (violations fixed vs. remaining)
- Update the refactoring plan as needed
- Seek feedback before continuing
STOP HERE AND WAIT FOR FEEDBACK BEFORE PROCEEDING.

## Step 6: Final Verification
Once all violations appear to be fixed, perform these final checks:
- Run a complete PEP8 check:
```
./run.sh pep-check
```
- Run the full test suite:
```
./run.sh test
```
Summarize all changes made and confirm everything is PEP8 compliant while maintaining functionality.
STOP HERE AND WAIT FOR FEEDBACK BEFORE CONCLUDING.
Remember: Follow these steps exactly, make changes conservatively, and stop for feedback after each step. Do not proceed until explicitly instructed to do so.
